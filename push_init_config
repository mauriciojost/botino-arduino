#!/usr/bin/env bash

DEVICE=${1:-dev1}

PRETTY='python -m json.tool'

# Set up general settings
url="http://dweet.io/dweet/for/$DEVICE-settings-target?"
url+='lcddebug=false&' # turn on/off LCD DEBUG (show logs in LCD)
url+='crashclear=false&' # do not clear debug info (stacktraces) from device
url+='loglevel=1' # log level
curl -XPOST $url | $PRETTY

# Set up body
# Routine 0: smile and turn a LED showing H20 in the LCD, then show the time, and sleep
# Routine 1: show the current time, and sleep
url="http://dweet.io/dweet/for/$DEVICE-body-target?"
url+="msg0=H2O&" # custom message
url+="mv0=Fs.LwyM05W5.Mc4W5.Zz.&" # move
url+="mv1=Mc4W5.Zz.&" # move
url+="mv2=S00S01S02S01Zz.&" # move
url+="mv3=Mq1&" # move
url+="t0=201013060&" # timing
url+="t1=201010160&" # timing
url+="t2=0&" # timing
url+="t3=0" # timing
curl -XPOST $url | $PRETTY

# Set up properties synchronizer
url="http://dweet.io/dweet/for/$DEVICE-propsync-target?"
url+="freq=201011560" # sync all properties every 5 minutes
curl -XPOST $url | $PRETTY

# Set up setup synchronizer (for wifi setup)
#url="http://dweet.io/dweet/for/$DEVICE-setupsync-target?"
#url+="freq=201010560" # sync all properties every 5 minutes
#curl -XPOST $url | $PRETTY

